
<!DOCTYPE html>

<html lang="vi">
<head>
<meta charset="utf-8"/>
<title>Danh S√°ch Thi·∫øt B·ªã - N·ªòI 1</title>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
    body { font-family: 'Segoe UI', sans-serif; background: #f0f8ff; padding: 20px; }
    h2 { text-align: center; color: #007bff; }
    .form { display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 10px; background: #fff; padding: 20px; border-radius: 10px; margin-bottom: 20px; }
    input { padding: 8px; border: 1px solid #ccc; border-radius: 6px; }
    button { padding: 10px 16px; border: none; background: #007bff; color: white; border-radius: 6px; cursor: pointer; }
    button:hover { background: #0056b3; }
    table { border-collapse: collapse; width: 100%; background: white; }
    th, td { border: 1px solid #ccc; padding: 6px; text-align: center; }
    th { background: #cce5ff; }
  </style>
</head>
<body>
<h2>ü©∫ DANH S√ÅCH THI·∫æT B·ªä ‚Äì N·ªòI 1</h2>
<div class="form">
<input id="id" type="hidden"/>
<input id="stt" placeholder="STT"/>
<input id="ten_ttb" placeholder="T√™n TTB"/>
<input id="ma_ttb" placeholder="M√£ TTB"/>
<input id="serial" placeholder="Serial"/>
<input id="dvt" placeholder="DVT"/>
<input id="sl" placeholder="SL"/>
<input id="tg_bh" placeholder="TG-BH"/>
<input id="tinh_trang" placeholder="T√¨nh tr·∫°ng"/>
<input id="gia_tri" placeholder="Gi√° tr·ªã"/>
<input id="tb_di_kem" placeholder="TB ƒëi k√®m"/>
<input id="sua_chua" placeholder="S·ª≠a ch·ªØa"/>
<button onclick="save()">L∆∞u</button>
<button onclick="exportExcel()">Xu·∫•t Excel</button>
<button onclick="exportPDF()">Xu·∫•t PDF</button>
</div>
<table id="deviceTable">
<thead>
<tr>
<th>STT</th><th>T√™n TTB</th><th>M√£ TTB</th><th>Serial</th><th>DVT</th><th>SL</th><th>TG-BH</th>
<th>T√¨nh tr·∫°ng</th><th>Gi√° tr·ªã</th><th>TB ƒëi k√®m</th><th>S·ª≠a ch·ªØa</th><th>S·ª≠a</th><th>Xo√°</th>
</tr>
</thead>
<tbody></tbody>
</table>
<script>
    const supabase = window.supabase.createClient(
      'https://dgugkjnnxfnrffmirvfz.supabase.co',
      'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRndWdraG5ueGZucmZmbWlydmZ6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE2OTk2MjAxMDUsImV4cCI6MjAxNTE5NjEwNX0.Ot7eF1hQ6Wz1jW06qItbWn1B1A_5CMaIvTNNHeZx1Zw'
    );

    async function load() {
      const { data } = await supabase.from('devices').select('*').eq('kp_nhan', 'N·ªòI 1').order('stt');
      const tbody = document.querySelector('tbody');
      tbody.innerHTML = '';
      data.forEach(d => {
        tbody.innerHTML += `<tr>
          <td>${d.stt}</td><td>${d.ten_ttb}</td><td>${d.ma_ttb}</td><td>${d.serial}</td><td>${d.dvt}</td>
          <td>${d.sl}</td><td>${d.tg_bh}</td><td>${d.tinh_trang}</td><td>${d.gia_tri}</td><td>${d.tb_di_kem}</td><td>${d.sua_chua}</td>
          <td><button onclick="edit('${d.id}', ${d.stt}, '${d.ten_ttb}', '${d.ma_ttb}', '${d.serial}', '${d.dvt}', '${d.sl}', '${d.tg_bh}', '${d.tinh_trang}', '${d.gia_tri}', '${d.tb_di_kem}', '${d.sua_chua}')">‚úèÔ∏è</button></td>
          <td><button onclick="del('${d.id}')">üóë</button></td>
        </tr>`;
      });
    }

    function edit(id, stt, ten, ma, serial, dvt, sl, tg_bh, tinh_trang, gia_tri, tb_di_kem, sua_chua) {
      document.getElementById('id').value = id;
      document.getElementById('stt').value = stt;
      document.getElementById('ten_ttb').value = ten;
      document.getElementById('ma_ttb').value = ma;
      document.getElementById('serial').value = serial;
      document.getElementById('dvt').value = dvt;
      document.getElementById('sl').value = sl;
      document.getElementById('tg_bh').value = tg_bh;
      document.getElementById('tinh_trang').value = tinh_trang;
      document.getElementById('gia_tri').value = gia_tri;
      document.getElementById('tb_di_kem').value = tb_di_kem;
      document.getElementById('sua_chua').value = sua_chua;
    }

    async function save() {
      const id = document.getElementById('id').value;
      const data = {
        stt: parseInt(document.getElementById('stt').value),
        kp_nhan: 'N·ªòI 1',
        ten_ttb: document.getElementById('ten_ttb').value,
        ma_ttb: document.getElementById('ma_ttb').value,
        serial: document.getElementById('serial').value,
        dvt: document.getElementById('dvt').value,
        sl: document.getElementById('sl').value,
        tg_bh: document.getElementById('tg_bh').value,
        tinh_trang: document.getElementById('tinh_trang').value,
        gia_tri: document.getElementById('gia_tri').value,
        tb_di_kem: document.getElementById('tb_di_kem').value,
        sua_chua: document.getElementById('sua_chua').value
      };
      if (id) {
        await supabase.from('devices').update(data).eq('id', id);
      } else {
        await supabase.from('devices').insert(data);
      }
      document.getElementById('id').value = '';
      load();
    }

    async function del(id) {
      await supabase.from('devices').delete().eq('id', id);
      load();
    }

    function exportExcel() {
      const table = document.getElementById("deviceTable");
      const wb = XLSX.utils.table_to_book(table, { sheet: "NOI_1" });
      XLSX.writeFile(wb, "NOI_1.xlsx");
    }

    function exportPDF() {
      const doc = new jspdf.jsPDF();
      doc.text("Danh s√°ch thi·∫øt b·ªã - N·ªòI 1", 10, 10);
      doc.save("NOI_1.pdf");
    }

    load();
  </script>
<button onclick="themThietBi()">L∆∞u thi·∫øt b·ªã</button><script>
<script>
const khoaKey = "noi1";
let danhSach = JSON.parse(localStorage.getItem(khoaKey)) || [];

function renderTable() {
  const tbody = document.querySelector("tbody");
  tbody.innerHTML = "";
  danhSach.forEach((item, index) => {
    const row = `<tr>
      <td>${item.stt}</td>
      <td>${item.ten_ttb}</td>
      <td>${item.ma_ttb}</td>
      <td>${item.serial}</td>
      <td>${item.dvt}</td>
      <td>${item.sl}</td>
      <td>${item.tgbh}</td>
      <td>${item.tinhtrang}</td>
      <td>${item.giatri}</td>
      <td>${item.tb_dikem}</td>
      <td>${item.suachua}</td>
    </tr>`;
    tbody.innerHTML += row;
  });
}

function themThietBi() {
  const item = {
    stt: document.getElementById("stt").value,
    ten_ttb: document.getElementById("ten_ttb").value,
    ma_ttb: document.getElementById("ma_ttb").value,
    serial: document.getElementById("serial").value,
    dvt: document.getElementById("dvt").value,
    sl: document.getElementById("sl").value,
    tgbh: document.getElementById("tgbh").value,
    tinhtrang: document.getElementById("tinhtrang").value,
    giatri: document.getElementById("giatri").value,
    tb_dikem: document.getElementById("tb_dikem").value,
    suachua: document.getElementById("suachua").value,
  };
  danhSach.push(item);
  localStorage.setItem(khoaKey, JSON.stringify(danhSach));
  renderTable();
}

// Kh·ªüi ƒë·ªông
window.onload = renderTable;
</script>
</script></body>
</html>
